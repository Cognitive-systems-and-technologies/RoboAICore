# RoboAI Core Library
Кросплатформенная библиотека глубокого обучения, для мобильных роботов и ПК. Библиотека может применяться в направлениях, где требуется разработка систем, использующих нейронные сети, модели глубокого машинного обучения, обучение с подкреплением интеллектуальных агентов. 
Основными направлениями прикладного использования библиотеки:
- образовательная робототехника;
- мобильные роботы, машинки, манипуляторы и т.п.,
- устройства систем умного дома.

Пример обучения агента на базе stm32f429. Обучение происходит на аппаратной части stm32f429, используя алгоритм DeepRl из библиотеки. Данные о процессе обучения передаются при помощи модуля esp8266 в виде http сообщений на серверную часть для мониторинга. Мониторинг и управление агентом осуществляется при помощи веб интерфейса [NeuralInterface](https://github.com/Cognitive-systems-and-technologies/NeuralInterface)

Задача самообучения робота формулируется следующим образом:
Входной вектор (вектор состояния S) принимает значения с трех сенсоров HC-SR04 и имеет вид: [d1, d2, d3], где d – дистанция до препятствий.
Выход сети – вектор [a1, a2, a3], где а – оценка одного из трех действий, которые может выполнять агент. Действия a1-ехать прямо, a2-повернуть налево, a3-повернуть направо.
Функция поощрения имеет следующий вид: если нет препятствий, и выполняется действие a1 - агент получает максимальное поощрение, в противном случае агент получает поощрение в зависимости от дистанции до препятствий, чем она меньше, тем меньше поощрение. Также агент получает дополнительное поощрение при выходе за пределы ограниченной препятствиями зоны.
Все структуры и алгоритмы обучения выполняются на STM32F429. На локальный ПК передаются только данные для мониторинга и сигналы управления агентом.
Для обеспечения связи между агентом и сервером был использован модуль ESP8266, на котором реализован http-клиент для отправки запросов на глобальный сервер и локальный web-сервер для обработки входящих запросов.

https://github.com/Cognitive-systems-and-technologies/RoboAICore/assets/100981393/12a71c56-2717-4aa6-8c5e-a0d0802e9ae2

Пример работы обученного агента:

https://github.com/Cognitive-systems-and-technologies/RoboAICore/assets/100981393/c7fe27f1-373b-452e-93ad-8780ed5a95a5

Пример компиляции программы для stm32f429:

https://github.com/Cognitive-systems-and-technologies/RoboAICore/assets/100981393/9dda2685-c922-4ba5-9f9c-bd272eaf76bc

### Функции:
- Нейронные сети прямого распространения,
- Свёрточные нейронные сети,
- Алгоритмы обучения с подкреплением (deep RL)

### Адгоритмы оптимизации:
- SGD,
- Adagrad,
- RMSProp,
- Nesterov,
- Adam,
- Adan (Adaptive Nesterov Momentum Algorithm)

## Сборка и компиляция:
Проект был протестирован на: STM32f429, RaspberryPi 3 model B и персональном компьютере.

Требования для работы на микроконтроллерах:
- В библиотеке используется тип данных float, поэтому необходима поддержка микроконтроллером вычислений чисел с плавающей точкой (FPU). Для stm32 это, например, STM32F4xx, STM32F74x/5x, STM32L4xx, STM32F76x/7x и т.п.
- Объем оперативной памяти, требуемой для работы, зависит от размеров создаваемой модели и может варьироваться от нескольких десятков килобайт и до размеров доступной на устройстве памяти.
- Размер программируемой памяти от 500Кб и выше.
- Поддержка компилятором и наличие стандартных библиотек С (libc).

Проект использует систему сборки CMake.
Для сборки и компиляции проекта на ПК необходимо наличие установленной программы cmake и компилятора.

Для компиляции библиотеки с поддержкой вычислений на GPU необходимо установить инструментальные средства разработки для создания приложений для архитектуры CUDA - “NVIDIA GPU Computing Toolkit”. Загрузить пакет для установки можно на сайте nvidia по ссылке:
```
https://developer.nvidia.com/cuda-downloads
```
Поддерживаются графические процессоры с версией архитектуры compute_60 (Pascal) и выше.

Далее представлен процесс сборки и компиляции для операционной системы Windows на примере использования cmake-gui + Visual Studio MSVC:
- скопируйте репозиторий
```bash
 $ git clone --recursive https://github.com/Cognitive-systems-and-technologies/RoboAICore.git
```
- откройте cmake и укажите пути к папке с проектом и папке, в которую будет собран проект, затем нажмите "configure" и выберете тип проекта и компилятор (для VS можно оставить по умолчанию),
- после завершения конфигурации нажмите "generate" и "open project". Проект откроется в VIsual Studio,
- в окне Visual Studio выберите тип компиляции и в меню "Build"->"Rebuild solution".

https://github.com/Cognitive-systems-and-technologies/RoboAICore/assets/100981393/3f293dad-f79e-4311-9cd7-68e277f902dc

Далее представлен процесс сборки на RaspberryPi для операционной системы Debian Linux:
- скопируйте репозиторий
- выполните команды для обновления и установки cmake
```
sudo apt update
sudo apt install -y cmake
```
- перейдите в папку с исходным кодом и запустите командную строку из дирректории
- выполните следующие команды для сборки проекта и компиляции:
```
cmake .
make
```

https://github.com/Cognitive-systems-and-technologies/RoboAICore/assets/100981393/a33fce38-b1c1-4e9d-a61a-3d87e6776f97

После компиляции будут созданы исполняемые файлы с примерами создания и обучения моделей. Файлы с кодом примеров расположены в папке cmd:
[примеры](https://github.com/Cognitive-systems-and-technologies/RoboAICore/tree/main/src/cmd). Список примеров:
- cuda_test.cu - пример создания и обучения модели на GPU,
- rand_test.cpp - пример работы алгоритмов для инициализации весовых коэффициентов,
- opt_test.cpp - пример создания и обучения модели на CPU,
- mult_opt_test.cpp - пример создания и обучения модели с несколькими выходами на CPU,
- model_test.cpp - пример создания глубокой модели нейросети,
- data_test.cpp - пример работы с данными и функциями слоев.

## Ресурсы:
- Описание функций библиотеки [RoboAICore API](https://github.com/Cognitive-systems-and-technologies/materials/blob/main/RAI_API.pdf).
